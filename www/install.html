<html>
	<head>
		<title>Installing SubEtha</title>
		
		<style type="text/css">
			/* <![CDATA[ */ 
			@import "http://www.tigris.org/branding/css/tigris.css"; 
			@import "http://www.tigris.org/branding/css/inst.css"; 
			/*  ]]> */
		</style>
		<link rel="stylesheet" type="text/css" href="http://www.tigris.org/branding/css/print.css" media="print" />
		<script src="http://www.tigris.org/branding/scripts/tigris.js" type="text/javascript">
		</script>
	</head>

	<body>
		<div class="app">
			<h2>How to Install SubEtha</h2>
			
			<p>
				As opposed to the developer documentation, these instructions describe
				how to set up SubEtha for production use.  In the future, SubEtha will
				come as a RPM or DEB package which includes JBoss preconfigured.
			</p>
		
			<p>
				These instructions describe setting up a single, standalone
				instance of SubEtha.  If you wish to run a cluster you should
				consult a JBoss expert.  You should have have installed
				JDK 1.5 and whatever database you intend to use.
			</p>
			
			<ul>
				<li>
					Install <a href="http://labs.jboss.com/portal/jbossas/download">JBoss 4.0.4.GA</a>
					using the installer (not the zip download!).
					<ol>
						<li>Choose the ejb3 (NOT ejb3-clustered) option.</li>
						<li>Leave the configuration name as 'default'.</li>
						<li>Do NOT enable deployment isolation/call-by-value.</li>
						<li>Secure all of the JMX access points.  <strong>Be sure to use a non-guessable password</strong>.</li>
					</ol>
					The remaining documentation referrs to the directory in which you
					installed JBoss as ${jboss.dir}.
				</li>
				<li>
					SubEtha uses JavaMail to send messages through an existing Mail Transport Agent
					such as Postfix or Sendmail.  Edit the configuration in
					${jboss.dir}/server/default/deploy/mail-service.xml and set the
					following parameters:
					<ul>
						<li>mail.smtp.host - the name of your outgoing smtp mail server (probably "localhost")</li>
						<li>mail.smtp.port - the port number of your outgoing smtp mail server (probably 25)</li>
						<li>mail.smtp.allow8bitmime - set to "true" to optionally create more efficient email.  Most modern MTAs (ie Postfix) can handle this.</li>
					</ul>
				</li>
				<li>
					Set up the JDBC data source.
					<ol>
						<li>Copy an appropriate JDBC driver for your database into ${jboss.dir}/server/default/lib.</li>
						<li>
							Configure a data source appropriate to your particular database by copying one of
							the templates in ${jboss.dir}/docs/examples/jca/ into ${jboss.dir}/server/default/deploy/.
							There are examples for most modern RDBMSes.  You must change the jndi-name to
							be SubEthaDS:
							<blockquote>&lt;jndi-name&gt;SubEthaDS&lt;/jndi-name&gt;</blockquote>
							The filename is arbitrary but it should end with -ds.xml.
						</li>
						<li>
							Create the schema (not the tables) that you referenced in your -ds.xml file.
							For example, if you used a JDBC url of 
							<blockquote>&lt;connection-url&gt;jdbc:mysql://localhost:3306/subetha&lt;/connection-url&gt;</blockquote>
							make sure that you create a database schema named "subetha".
						</li>
						<li>Note that JBoss will create the database tables for you when SubEtha runs for the first time.</li>
					</ol>
				</li>
				<li>
					Copy subetha.ear to ${jboss.dir}/server/default/deploy/.
				</li>
				<li>
					Configure the startup scripts.  You probably want to add -Dfile.encoding=UTF-8 to
					the JAVA_OPTS environment variable (check ${jboss.dir}/bin/run.sh or run.bat).
					If you are using Linux, example scripts suitable for /etc/init.d are
					located in ${jboss.dir}/bin/.  They will require some customization for your environment.
				</li>
			</ul>
	
			<h2>Startup</h2>
			<p>
				Start up JBoss by running ${jboss.dir}/bin/run.sh or run.bat.
				The default web interface is <a href="http://localhost:8080/se/">http://localhost:8080/se/</a>.
				When SubEtha runs for the first time, it creates a site administrator
				account named "<strong>root@localhost</strong>", with the password
				"<strong>password</strong>".
			</p>
			<p>
				<strong>Change the administrator password immediately</strong>.
				This can be done from the web interface.
			</p>
			
			<p>
				You are now ready to continue with the <a href="administration.html">Administration Guide</a>.
			</p>

		</div>
	</body>
</html>